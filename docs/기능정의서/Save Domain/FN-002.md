FN-002: Background Content Processor
- Purpose / Value – Process queued content saves without blocking UI
- Scope / Module – features/save/domain/services/background_processor
- Primary Actor(s) – System, Background Worker
- Triggers –
  - App launch
  - 30-minute interval
  - Manual refresh
  - New item in queue
- Inputs –
  - Queue of PendingSave objects
  - Processing priority rules
  - Network status
- Processing Logic –
  1. Query pending_saves table
  2. Sort by priority (newest first, retry count)
  3. Check network and battery status
  4. Process up to 3 items in parallel
  5. Call appropriate parser for each URL
  6. Request AI tagging
  7. Save to local database
  8. Download media assets
  9. Update queue status
- Outputs –
  - Processed count (Integer)
  - Failed items list
  - Processing statistics
- Business Rules & Constraints –
  - Max 3 retries per item
  - WiFi-only for media > 5MB
  - Battery > 20% required
  - 30s timeout per item
- Error Handling & Edge Cases –
  - Parser failure → Mark as failed, notify user
  - Network loss → Pause and retry
  - Storage full → Clean old cache
  - App killed → Resume on next launch
- Data Model Touchpoints –
  - pending_saves (READ/UPDATE/DELETE)
  - contents (CREATE)
  - processing_logs (CREATE)
- API Endpoints / Methods – Background job (no API)
- Permissions / Security –
  - Background execution permission
  - Network state access
- Performance / SLA Notes –
  - Process 100 items/hour
  - Memory usage < 200MB
- UX References –
  - ProcessingNotification
  - QueueStatusIndicator
- Dependencies –
  - workmanager: ^0.5.0
  - background_fetch: ^1.1.0
- Acceptance Criteria –
  - 95% processing success rate
  - Continues after app close
  - Respects system resources
  - Status updates in real-time
- Code Pointers –
  - lib/features/save/domain/services/background_processor.dart
  - lib/core/background/work_manager_setup.dart